<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Routine for local multiple regression — local.multiple.regression • wavemulcor</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Routine for local multiple regression — local.multiple.regression" />
<meta property="og:description" content="Produces an estimate of local multiple regressions
(as defined below) along with approximate confidence intervals." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wavemulcor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/wavemulcor-vignette.html">**wavemulcor:**</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Routine for local multiple regression</h1>
    
    <div class="hidden name"><code>local.multiple.regression.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Produces an estimate of local multiple regressions
(as defined below) along with approximate confidence intervals.</p>
    </div>

    <pre class="usage"><span class='fu'>local.multiple.regression</span>(<span class='no'>xx</span>, <span class='no'>M</span>, <span class='kw'>window</span><span class='kw'>=</span><span class='st'>"gauss"</span>, <span class='kw'>p</span><span class='kw'>=</span><span class='fl'>.975</span>, <span class='kw'>ymaxr</span><span class='kw'>=</span><span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>xx</th>
      <td><p>A list of \(n\) time series, <em>e.g.</em>
 xx &lt;- list(v1, v2, v3)</p></td>
    </tr>
    <tr>
      <th>M</th>
      <td><p>length of the weight function or rolling window.</p></td>
    </tr>
    <tr>
      <th>window</th>
      <td><p>type of weight function or rolling window.
Six types are allowed, namely
the uniform window,
Cleveland or tricube window,
Epanechnikov or parabolic window,
Bartlett or triangular window,
Wendland window and
the gaussian window.
The letter case and length of the argument are not relevant
as long as at least the first four characters are entered.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p></td>
    </tr>
    <tr>
      <th>ymaxr</th>
      <td><p>index number of the variable whose correlation is calculated against a linear combination
 of the rest, otherwise at each wavelet level lmc chooses the one maximizing the multiple correlation.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The routine calculates a set of time series of multiple regression coeffcients out of \(n\) variables.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List of four elements:</p>
<dt>cor: </dt><dd><p>List of three elements:</p></dd>

val:  numeric vector (rows = #observations) of point estimates for the local multiple correlation.
lo:  numeric vector (rows = #observations) of lower bounds of the confidence interval.
up:  numeric vector (rows = #observations) of upper bounds of the confidence interval.

<dt>reg: </dt><dd><p>List of seven elements:</p></dd>

rval:  numeric matrix (rows = #observations, cols = #regressors+1) of local regression estimates.
rstd:  numeric matrix (rows = #observations, cols = #regressors+1) of their standard deviations.
rlow:  numeric matrix (rows = #observations, cols = #regressors+1) of their lower bounds.
rupp:  numeric matrix (rows = #observations, cols = #regressors+1) of their upper bounds.
rtst:  numeric matrix (rows = #observations, cols = #regressors+1) of their t statistic values.
rord:  numeric matrix (rows = #observations, cols = #regressors+1) of their index order when sorted by significance.
rpva:  numeric matrix (rows = #observations, cols = #regressors+1) of their p values.

<dt>YmaxR: </dt><dd><p>numeric vector (rows = #observations) giving, at each value in time, the index number of the variable
whose correlation is calculated against a linear combination of the rest.
By default, <em>lmr</em> chooses at each value in time the variable maximizing the multiple correlation.</p></dd>
<dt>data: </dt><dd><p>dataframe (rows = #observations, cols = #regressors) of original data.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fernández-Macho, J., 2018. Time-localized wavelet multiple regression and correlation, Physica A:
Statistical Mechanics, vol. 490, p. 1226--1238. &lt;DOI:10.1016/j.physa.2017.11.050&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Based on  Figure 4 showing correlation structural breaks in Fernandez-Macho (2018).</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>wavemulcor</span>)
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span>(<span class='kw'>warn</span> <span class='kw'>=</span> -<span class='fl'>1</span>)

<span class='no'>xrand1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>wavemulcor</span><span class='kw ns'>::</span><span class='no'><a href='xrand1.html'>xrand1</a></span>
<span class='no'>xrand2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>wavemulcor</span><span class='kw ns'>::</span><span class='no'><a href='xrand2.html'>xrand2</a></span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>xrand1</span>)
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>trunc</a></span>(<span class='no'>N</span>/<span class='fl'>3</span>)
<span class='no'>t1</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='no'>b</span>
<span class='no'>t2</span> <span class='kw'>&lt;-</span> (<span class='no'>b</span>+<span class='fl'>1</span>):(<span class='fl'>2</span>*<span class='no'>b</span>)
<span class='no'>t3</span> <span class='kw'>&lt;-</span> (<span class='fl'>2</span>*<span class='no'>b</span>+<span class='fl'>1</span>):<span class='no'>N</span>

<span class='no'>wf</span> <span class='kw'>&lt;-</span> <span class='st'>"d4"</span>
<span class='no'>M</span> <span class='kw'>&lt;-</span> <span class='no'>N</span>/<span class='fl'>2</span>^<span class='fl'>3</span> <span class='co'>#sharper with N/2^4</span>
<span class='no'>window</span> <span class='kw'>&lt;-</span> <span class='st'>"gaussian"</span>

<span class='no'>J</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>trunc</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log2</a></span>(<span class='no'>N</span>))-<span class='fl'>3</span>

<span class='co'># ---------------------------</span>

<span class='no'>cor1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span>(<span class='no'>xrand1</span>[<span class='no'>t1</span>],<span class='no'>xrand2</span>[<span class='no'>t1</span>])
<span class='no'>cor2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span>(<span class='no'>xrand1</span>[<span class='no'>t2</span>],<span class='no'>xrand2</span>[<span class='no'>t2</span>])
<span class='no'>cor3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span>(<span class='no'>xrand1</span>[<span class='no'>t3</span>],<span class='no'>xrand2</span>[<span class='no'>t3</span>])
<span class='no'>cortext</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='fl'>100</span>*<span class='no'>cor1</span>,<span class='fl'>0</span>),<span class='st'>"-"</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='fl'>100</span>*<span class='no'>cor2</span>,<span class='fl'>0</span>),<span class='st'>"-"</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='fl'>100</span>*<span class='no'>cor3</span>,<span class='fl'>0</span>))

<span class='fu'><a href='https://rdrr.io/r/stats/ts.plot.html'>ts.plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>xrand1</span>,<span class='no'>xrand2</span>),<span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"red"</span>,<span class='st'>"blue"</span>),<span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"time"</span>)</div><div class='img'><img src='local.multiple.regression-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>xx</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='no'>xrand1</span>,<span class='no'>xrand2</span>)

<span class='co'># ---------------------------</span>

<span class='no'>Lst</span> <span class='kw'>&lt;-</span> <span class='fu'>local.multiple.regression</span>(<span class='no'>xx</span>, <span class='no'>M</span>, <span class='kw'>window</span><span class='kw'>=</span><span class='no'>window</span>) <span class='co'>#, ymax=1)</span>

<span class='co'># ---------------------------</span>

<span class='co'>##Producing correlation plot</span>
<span class='fu'><a href='plot_local.multiple.correlation.html'>plot_local.multiple.correlation</a></span>(<span class='no'>Lst</span>)</div><div class='img'><img src='local.multiple.regression-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; NULL</div><div class='input'>
<span class='co'>##Producing regression plot</span>
<span class='fu'><a href='plot_local.multiple.regression.html'>plot_local.multiple.regression</a></span>(<span class='no'>Lst</span>)</div><div class='img'><img src='local.multiple.regression-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; NULL</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Javier Fernandez-Macho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


