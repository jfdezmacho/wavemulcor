<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Wavelet routine for multiple correlation — wave.multiple.correlation • wavemulcor</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Wavelet routine for multiple correlation — wave.multiple.correlation" />
<meta property="og:description" content="Produces an estimate of the multiscale multiple correlation
 (as defined below) along with approximate confidence intervals." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wavemulcor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/wavemulcor-vignette.html">**wavemulcor:**</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Wavelet routine for multiple correlation</h1>
    
    <div class="hidden name"><code>wave.multiple.correlation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Produces an estimate of the multiscale multiple correlation
 (as defined below) along with approximate confidence intervals.</p>
    </div>

    <pre class="usage"><span class='fu'>wave.multiple.correlation</span>(<span class='no'>xx</span>, <span class='no'>N</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>0.975</span>, <span class='kw'>ymaxr</span><span class='kw'>=</span><span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>xx</th>
      <td><p>A list of \(n\) (multiscaled) time series, usually the outcomes of dwt or modwt, <em>i.e.</em>
 xx &lt;- list(v1.modwt.bw, v2.modwt.bw, v3.modwt.bw)</p></td>
    </tr>
    <tr>
      <th>N</th>
      <td><p>length of the time series</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>one minus the two-sided p-value for the confidence interval, <em>i.e.</em> the cdf value.</p></td>
    </tr>
    <tr>
      <th>ymaxr</th>
      <td><p>index number of the variable whose correlation is calculated against a linear combination
 of the rest, otherwise at each wavelet level wmc chooses the one maximizing the multiple correlation.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The routine calculates one single set of wavelet multiple correlations out of \(n\) variables
 that can be plotted in a single graph, as an
 alternative to trying to make sense out of \(n(n-1)/2\) sets of wavelet correlations. The code is
 based on the calculation, at each wavelet scale, of the square root of the coefficient of
 determination in the linear combination of variables for which such coefficient of determination
 is a maximum. The code provided here is based on the <em>wave.correlation</em> routine in Brandon
 Whitcher's <em>waveslim</em> <span style="R">R</span> package Version: 1.6.4, which in turn is based on wavelet methodology
 developed in Percival and Walden (2000); Gençay, Selçuk and Whitcher (2001) and others.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List of two elements:</p>
<dt>xy.mulcor:</dt><dd><p>numeric matrix with as many rows as levels in the wavelet transform object.
 The first column provides the point estimate for the wavelet multiple correlation,
 followed by the lower and upper bounds from the confidence interval.</p></dd>
<dt>YmaxR:</dt><dd><p>numeric vector giving, at each wavelet level, the index number of the variable whose correlation is calculated against a linear combination of the rest. By default, <em>wmc</em> chooses at each wavelet level the variable maximizing the multiple correlation.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fernández-Macho, J., 2012. Wavelet multiple correlation and cross-correlation: A multiscale analysis of Eurozone stock markets. Physica A: Statistical Mechanics and its Applications 391, 1097--1104. &lt;DOI:10.1016/j.physa.2011.11.002&gt;</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Needs <em>waveslim</em> package to calculate <em>dwt</em> or <em>modwt</em> coefficients as inputs to the routine (also for data in the example).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Based on data from Figure 7.8 in Gencay, Selcuk and Whitcher (2001)</span>
<span class='co'>## plus one random series.</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>wavemulcor</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>exchange</span>)
<span class='no'>returns</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>exchange</span>)))
<span class='no'>returns</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/ts.html'>ts</a></span>(<span class='no'>returns</span>, <span class='kw'>start</span><span class='kw'>=</span><span class='fl'>1970</span>, <span class='kw'>freq</span><span class='kw'>=</span><span class='fl'>12</span>)
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span>(<span class='no'>returns</span>)[<span class='fl'>1</span>]

<span class='no'>wf</span> <span class='kw'>&lt;-</span> <span class='st'>"d4"</span>
<span class='no'>J</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>trunc</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log2</a></span>(<span class='no'>N</span>))-<span class='fl'>3</span>

<span class='no'>demusd.modwt</span> <span class='kw'>&lt;-</span> <span class='fu'>modwt</span>(<span class='no'>returns</span>[,<span class='st'>"DEM.USD"</span>], <span class='no'>wf</span>, <span class='no'>J</span>)
<span class='no'>demusd.modwt.bw</span> <span class='kw'>&lt;-</span> <span class='fu'>brick.wall</span>(<span class='no'>demusd.modwt</span>, <span class='no'>wf</span>)
<span class='no'>jpyusd.modwt</span> <span class='kw'>&lt;-</span> <span class='fu'>modwt</span>(<span class='no'>returns</span>[,<span class='st'>"JPY.USD"</span>], <span class='no'>wf</span>, <span class='no'>J</span>)
<span class='no'>jpyusd.modwt.bw</span> <span class='kw'>&lt;-</span> <span class='fu'>brick.wall</span>(<span class='no'>jpyusd.modwt</span>, <span class='no'>wf</span>)
<span class='no'>rand.modwt</span> <span class='kw'>&lt;-</span> <span class='fu'>modwt</span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>returns</span>[,<span class='st'>"DEM.USD"</span>])), <span class='no'>wf</span>, <span class='no'>J</span>)
<span class='no'>rand.modwt.bw</span> <span class='kw'>&lt;-</span> <span class='fu'>brick.wall</span>(<span class='no'>rand.modwt</span>, <span class='no'>wf</span>)

<span class='no'>xx</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>demusd.modwt.bw</span>, <span class='no'>jpyusd.modwt.bw</span>, <span class='no'>rand.modwt.bw</span>)

<span class='no'>Lst</span> <span class='kw'>&lt;-</span> <span class='fu'>wave.multiple.correlation</span>(<span class='no'>xx</span>, <span class='kw'>N</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>xx</span><span class='kw'>[[</span><span class='fl'>1</span>]]<span class='kw'>[[</span><span class='fl'>1</span>]]))
<span class='no'>returns.modwt.cor</span> <span class='kw'>&lt;-</span> <span class='no'>Lst</span>$<span class='no'>xy.mulcor</span>[<span class='fl'>1</span>:<span class='no'>J</span>,]
<span class='no'>YmaxR</span> <span class='kw'>&lt;-</span> <span class='no'>Lst</span>$<span class='no'>YmaxR</span>

<span class='no'>exchange.names</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"DEM.USD"</span>, <span class='st'>"JPY.USD"</span>, <span class='st'>"RAND"</span>)

<span class='co'>##Producing plot</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>), <span class='kw'>las</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>mar</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>2</span>)+<span class='fl'>.1</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/matplot.html'>matplot</a></span>(<span class='fl'>2</span>^(<span class='fl'>0</span>:(<span class='no'>J</span>-<span class='fl'>1</span>)), <span class='no'>returns.modwt.cor</span>[-(<span class='no'>J</span>+<span class='fl'>1</span>),], <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"b"</span>,
  <span class='kw'>log</span><span class='kw'>=</span><span class='st'>"x"</span>, <span class='kw'>pch</span><span class='kw'>=</span><span class='st'>"*LU"</span>, <span class='kw'>xaxt</span><span class='kw'>=</span><span class='st'>"n"</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>4</span>,<span class='fl'>4</span>),
  <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Wavelet Scale"</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Wavelet Multiple Correlation"</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span>(<span class='kw'>side</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>at</span><span class='kw'>=</span><span class='fl'>2</span>^(<span class='fl'>0</span>:<span class='fl'>7</span>))</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='kw'>h</span><span class='kw'>=</span><span class='fl'>0</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span>(<span class='fl'>2</span>^(<span class='fl'>0</span>:<span class='fl'>7</span>), <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='no'>returns.modwt.cor</span>[-(<span class='no'>J</span>+<span class='fl'>1</span>),])-<span class='fl'>0.03</span>,
  <span class='kw'>labels</span><span class='kw'>=</span><span class='no'>exchange.names</span>[<span class='no'>YmaxR</span>], <span class='kw'>adj</span><span class='kw'>=</span><span class='fl'>0.5</span>, <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>.5</span>)</div><div class='img'><img src='wave.multiple.correlation-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Javier Fernandez-Macho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


