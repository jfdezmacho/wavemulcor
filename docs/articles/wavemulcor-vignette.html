<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>**wavemulcor:** • wavemulcor</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="**wavemulcor:**">
<meta property="og:description" content="wavemulcor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wavemulcor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/wavemulcor-vignette.html">**wavemulcor:**</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip><strong>wavemulcor:</strong></h1>
            <h3 class="subtitle"></h3>
<p>Wavelet Routines for Global and Local</p>
Multiple Regression and Correlation
                        <h4 class="author">J Fernández-MachoDpt. of Quantitative MethodsUniversity of the Basque Country (UPV/EHU)</h4>
            
            <h4 class="date">2020-05-19</h4>
      
      
      <div class="hidden name"><code>wavemulcor-vignette.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Wavelet routines that calculate single sets of wavelet multiple regressions and correlations (WMR and WMC), and cross-regressions and cross-correlations (WMCR and WMCC) from a multivariate time series. Also, dynamic versions of the routines allow the wavelet local multiple (cross-)regressions (WLMR and WLMCR) and (cross-)correlations (WLMC and WLMCC) to evolve over time. They can later be plotted in single graphs, as an alternative to trying to make sense out of several sets of wavelet correlations or wavelet cross-correlations. The code is based on the calculation, at each wavelet scale, of the square root of the coefficient of determination in a linear combination of variables for which such coefficient of determination is a maximum.</p>
    </div>
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Data evolution along time may be the consequence of heterogeneous causes occurring at different time scales or frequencies. This is not easily taken into account by traditional time series analysis (TSA) either in the time domain or in the frequency domain (Fourier analysis). These two approaches take opposite ways of exposing the information present in the time series under study. Thus, time domain TSA provides full time resolution at the cost of discarding all frequency information and, conversely, Fourier analysis has full frequency resolution but no information in time. The more recent wavelet analysis gets sort of in the middle by offering a compromise, with partial resolution in both time and frequency domains, so that we can separate periodic components at different timescales and observe how they evolve over time <span class="citation">(Percival and Walden 2000; Aguiar-Conraria and Soares 2014)</span>.</p>
<div id="wavelet-correlation" class="section level3">
<h3 class="hasAnchor">
<a href="#wavelet-correlation" class="anchor"></a>Wavelet correlation</h3>
<p>Just like the standard correlation measure, wavelet correlation aims to evaluate the degree of association between two time series but on a scale-by-scale basis. Since the seminal work of Whitcher <em>etal.</em> <span class="citation">(2000)</span> and the release of the <em>waveslim</em> package <span class="citation">(Whitcher 2015)</span>, pairwise wavelet correlations haven been widely used in many different scientific fields. However, standard wavelet correlations are restricted to pairs of time series. This is not helpful when dealing with a set of several time series since we would need to handle many wavelet correlation graphs and even more cross-correlation graphs. In this case, we would rather ask for a single measure of the overall association among them. Of course, this is even complicated further if we want to extend the comparison to the actual plethora of regression coefficients involved.</p>
</div>
<div id="wavelet-multiple-regression-and-correlation" class="section level3">
<h3 class="hasAnchor">
<a href="#wavelet-multiple-regression-and-correlation" class="anchor"></a>Wavelet multiple regression and correlation</h3>
<p>The wavelet multiple regression and correlation analysis proposed in Fernández-Macho <span class="citation">(2012, 2018)</span> extends wavelet correlation methodology to handle multivariate time series. As their names imply, the wavelet multiple regression (WMR) and cross-regression (WMCR) estimate a complete set of regression coefficients, together with their corresponding standard deviations and significance statistics, related to the overall statistical relationships that might exist at different timescales among observations on a multivariate time series. As special cases, the wavelet multiple correlation (WMC) and cross-correlation (WMCC) refer to just the actual measure of the degree of overall statistical relationships within the multivariate set of variables.</p>
</div>
<div id="local-vs--global-wavelet-multiple-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#local-vs--global-wavelet-multiple-regression" class="anchor"></a>Local vs. global wavelet multiple regression</h3>
<p>Similarly, in a non-stationary context, the wavelet local multiple regression (WLMR) and correlation (WLMC) estimate and measure the time-evolving statistical relationships at different timescales within a multivariate data set. The usual practice of combining standard bivariate wavelet correlation analysis with rolling time windows is clearly inadequate as this needs to calculate, plot and compare a large number of wavelet regression and correlation graphs that now would require an additional time dimension. This renders pairwise multiscale comparisons pointless in practice. <!-- see [@Ranta10;@DajcmFK12;@Ranta13;@Benhm13;@TiwarMA16] among others, for examples just involving correlations. --> Besides, some consideration as to appropriateness of the usual rectangular rolling window needs to be taken into account. See Fernández-Macho <span class="citation">(2018, 2019)</span> for a brief introduction to wavelet methods and a discussion of the spectral properties of local windows needed for dynamic wavelet methods.</p>
</div>
</div>
<div id="the-wavemulcor-package" class="section level2">
<h2 class="hasAnchor">
<a href="#the-wavemulcor-package" class="anchor"></a>The wavemulcor package</h2>
<p>Package <em>wavemulcor</em> produces estimates of multiscale global or local multiple regressions and correlations along with approximate confidence intervals. It makes use of the maximal overlap discrete wavelet transform described in Percival and Walden <span class="citation">(2000)</span>, and implemented by the <em>modwt</em> function in the <em>waveslim</em> <strong>R</strong> package developed by Whitcher <span class="citation">(2015)</span>. <!-- (see also [@GencaSW02]); --></p>
<p>It contains several routines <!-- wave.multiple.correlation}, {wave.multiple.cross.correlation} and {wave.local.multiple.correlation}, --> that calculate single sets of, respectively, global wavelet multiple regressions (WMC, WMR), global wavelet multiple cross-regressions (WMCC, WMCR) and time-localized wavelet multiple regressions (WLMC, WLMR) from a dataset of <span class="math inline">\(n\)</span> variables. <!-- They can later be plotted in single graphs, as an alternative to trying to make sense out of ${n(n-1)/2}$  --> <!-- sets of global wavelet correlations or ${n(n-1)/2 \cdot J}$ sets of global wavelet cross-correlations or  --> <!-- ${n(n-1)/2 \cdot [J \times T]}$ sets of local wavelet regressions and correlations respectively. --> The code is based on the calculation, at each wavelet scale <span class="math inline">\(\lambda_j\)</span>, of the square root of the coefficient of determination in that linear combination of either global or locally weighted wavelet coefficients for which such coefficient of determination is a maximum. For reference, we can write such linear combination as <span class="math inline">\(w_{yj}=\beta w_{xj}\)</span>, where <span class="math inline">\(w_{yj}\)</span> is the normalizing wavelet variable and <span class="math inline">\(\beta w_{xj}\)</span> is the linear combination of the rest of wavelet variables. Package <em>wavemulcor</em> can be obtained from The Comprehensive <strong>R</strong> Archive Network (CRAN) at <a href="https://cran.r-project.org/package=wavemulcor" class="uri">https://cran.r-project.org/package=wavemulcor</a>.</p>
<div id="wmr-wavelet-multiple-regression-and-correlation" class="section level3">
<h3 class="hasAnchor">
<a href="#wmr-wavelet-multiple-regression-and-correlation" class="anchor"></a>WMR: wavelet multiple regression and correlation</h3>
<p>These two wavelet routines produce estimates of multiscale multiple regressions together with their approximate confidence intervals.</p>
<p>The following example illustrates WMC with a tri-variate series consisting of the same exchange rate returns data as in Gençay <em>etal.</em> <span class="citation">(2002)</span>, DEM-USD, JPY-USD, <!-- Figure 7.8,  --> plus one random variable:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">wf</span> <span class="kw">&lt;-</span> <span class="st">"d4"</span>
<span class="no">J</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">trunc</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">N</span>))-<span class="fl">3</span>
<span class="no">demusd.modwt</span> <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="no">returns</span>[,<span class="st">"DEM.USD"</span>], <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)
<span class="no">jpyusd.modwt</span> <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="no">returns</span>[,<span class="st">"JPY.USD"</span>], <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)
<span class="no">xrand.modwt</span> <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">returns</span>[,<span class="st">"DEM.USD"</span>])), <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)

<span class="no">xx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">demusd.modwt</span>, <span class="no">jpyusd.modwt</span>, <span class="no">xrand.modwt</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">xx</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"DEM.USD"</span>,<span class="st">"JPY.USD"</span>,<span class="st">"rand"</span>)

<span class="no">Lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/wave.multiple.correlation.html">wave.multiple.correlation</a></span>(<span class="no">xx</span>)</pre></body></html></div>
<p>The output from this function consists of a list of two elements:</p>
<ul>
<li><p><em>xy.mulcor</em>, a <span class="math inline">\(J\times 3\)</span> matrix with as many rows as levels in the wavelet transform object. The first column provides the point estimate for the wavelet multiple correlation, followed by the lower and upper bounds from the confidence interval, and</p></li>
<li><p><em>YmaxR</em>, a numeric vector giving, at each wavelet level, the index number of the normalizing wavelet variable <span class="math inline">\(w_y\)</span> whose correlation is calculated (maximized by default) against a linear combination of the rest.</p></li>
</ul>
<p>The output can be presented in a table or graph using the <strong>R</strong> code of our choice. A quick but nice option is to use the auxiliary routine <em>plot_wave.multiple.correlation</em> that produces a standard WMC plot:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_wave.multiple.correlation.html">plot_wave.multiple.correlation</a></span>(<span class="no">Lst</span>)</pre></body></html></div>
<p><img src="wavemulcor-vignette_files/figure-html/plot_wmc-1.png" width="672"></p>
<p>The figure shows the wavelet multiple correlation for the exchange rate returns. The dashed lines correspond to the upper and lower bounds of the corresponding 95% confidence interval. The variables named on top<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> give, at each scale, the largest multiple correlation obtained from a linear combination of the variables. As an option, we can overrule this by explicitly naming the normalizing variable.</p>
<p>For a complete regression output we can use WMR. A similar code chunk as the one before provides an example of its usage, but with the last line replaced by:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">Lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/wave.multiple.regression.html">wave.multiple.regression</a></span>(<span class="no">xx</span>)</pre></body></html></div>
<p>It produces a first element with the same correlation output as <em>wave.multiple.correlation</em> plus a second element <em>xy.mulreg</em> with a list of relevant regression statistics, namely, the regression estimates at each wavelet level together with their standard deviations, confidence interval lower and upper bounds, the <span class="math inline">\(t\)</span> statistic values and p-values, and the indexes of the regressors when sorted by significance.</p>
<p>As before, this output can be fed into <strong>R</strong> code to produce tables and graphs of our choice. Alternatively, the auxiliary routine <em>plot_wave.multiple.regression</em> will give us a standard WMR plot:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_wave.multiple.regression.html">plot_wave.multiple.regression</a></span>(<span class="no">Lst</span>) <span class="co"># nsig=2)</span></pre></body></html></div>
<p><img src="wavemulcor-vignette_files/figure-html/plot_wmr-1.png" width="672"> The figure plots the wavelet multiple regression for the exchange rate returns, with different colors for each regression coefficient. The dashed lines correspond to the upper and lower bounds of their 95% confidence interval. Note that, in order not to crowd the plot excessively, we can choose to plot <em>nsig</em> regression coefficients only (the default is <span class="math inline">\(nsig=2\)</span>.) As before, the variables named on top give, at each scale, the largest multiple correlation from a linear combination of the variables. The names of the <em>nsig</em> most significant regressors are also printed along the regression wavelet line. The shaded area represent the compound 95% significance interval around zero.</p>
</div>
<div id="wmcr-wavelet-multiple-cross-regression-and-cross-correlation" class="section level3">
<h3 class="hasAnchor">
<a href="#wmcr-wavelet-multiple-cross-regression-and-cross-correlation" class="anchor"></a>WMCR: wavelet multiple cross-regression and cross-correlation</h3>
<p>Wavelet cross-regressions are, in principle, the same as wavelet regressions but with a temporal time shift between the normalizing wavelet variable <span class="math inline">\(w_y\)</span> and its regressors <span class="math inline">\(w_x\)</span> at each of the wavelet levels. If the shift is positive (<em>lag</em>) we say that <span class="math inline">\(y\)</span> lags the rest of the variables at that wavelet level, if it is negative (<em>lead</em>) we say that <span class="math inline">\(y\)</span> leads.</p>
<p>The next example uses WMCR (or WMCC) with the same tri-variate series of exchange rate returns data as before:</p>
<!-- (_cf_ [@GencaSW02], Figure~7.9): -->
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">wf</span> <span class="kw">&lt;-</span> <span class="st">"d4"</span>
<span class="no">J</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">trunc</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">N</span>))-<span class="fl">3</span>
<span class="no">lmax</span> <span class="kw">&lt;-</span> <span class="fl">36</span>

<span class="no">demusd.modwt</span> <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="no">returns</span>[,<span class="st">"DEM.USD"</span>], <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)
<span class="no">jpyusd.modwt</span> <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="no">returns</span>[,<span class="st">"JPY.USD"</span>], <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)
<span class="no">rand.modwt</span>   <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">returns</span>[,<span class="st">"DEM.USD"</span>])), <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)

<span class="co"># ---------------------------</span>

<span class="no">xx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">demusd.modwt</span>, <span class="no">jpyusd.modwt</span>, <span class="no">rand.modwt</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">xx</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"DEM.USD"</span>,<span class="st">"JPY.USD"</span>,<span class="st">"rand"</span>)

<span class="no">Lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/wave.multiple.cross.regression.html">wave.multiple.cross.regression</a></span>(<span class="no">xx</span>, <span class="no">lmax</span>)</pre></body></html></div>
<p>The output from this function is made up of several elements:<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<ul>
<li><p><em>xy.mulcor</em>, similar as before but taking into account the time shifts. That is, it contains <em>wavemulcor</em>, <em>lower</em>, <em>upper</em>, three <span class="math inline">\(J\times lmax\)</span> matrices of correlation coefficients and corresponding lower and upper bounds confidence interval bounds.</p></li>
<li><p><em>xy.mulreg</em>, with a list of arrays containing relevant regression statistics for all wavelet levels, and lags and leads.</p></li>
<li><p><em>YmaxR</em>, with the same content as <em>wave.multiple.regression</em> before.</p></li>
</ul>
<p>For a compact visualization with no confidence intervals, the cross-correlation output can be fed into a <em>heatmap_</em> auxiliary routine to obtain a standard heat map representation the WMCC:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/heatmap_wave.multiple.cross.correlation.html">heatmap_wave.multiple.cross.correlation</a></span>(<span class="no">Lst</span>, <span class="no">lmax</span>) <span class="co">#, by=3, ci=NULL, pdf.write=NULL)</span></pre></body></html></div>
<p><img src="wavemulcor-vignette_files/figure-html/heat_wmcc-1.png" width="672"></p>
<p>More generally, the output can also be fed into <em>plot_</em> auxiliary routines to obtain a standard WMCC plot:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_wave.multiple.cross.correlation.html">plot_wave.multiple.cross.correlation</a></span>(<span class="no">Lst</span>, <span class="no">lmax</span>) <span class="co">#, by=2)</span></pre></body></html></div>
<p><img src="wavemulcor-vignette_files/figure-html/plot_wmcc-1.png" width="672"></p>
<p>…and a standard WMCR plot:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_wave.multiple.cross.regression.html">plot_wave.multiple.cross.regression</a></span>(<span class="no">Lst</span>, <span class="no">lmax</span>) <span class="co">#, by=2)</span></pre></body></html></div>
<p><img src="wavemulcor-vignette_files/figure-html/plot_wmcr-1.png" width="672"></p>
<p>Both figures show, at one plot per wavelet level, the respective wavelet multiple cross-correlation and cross-regression coefficients for the exchange rate returns with their corresponding 95% confidence interval upper and lower bounds.</p>
</div>
<div id="wlmr-wavelet-local-multiple-regression-and-correlation" class="section level3">
<h3 class="hasAnchor">
<a href="#wlmr-wavelet-local-multiple-regression-and-correlation" class="anchor"></a>WLMR: wavelet local multiple regression and correlation</h3>
<p>This wavelet routine produces an estimate of the multiscale local multiple correlation from a set of <span class="math inline">\(n\)</span> variables together with approximate confidence intervals. The routine calculates one single set of wavelet multiple correlations over time that can be plotted in either one single heat map or <span class="math inline">\(J\)</span> line graphs (the former is useful if confidence intervals are explicitly needed but the latter is usually the best graphic option).</p>
<p>The third example uses WLMR (or WLMC) with the same tri-variate series of exchange rate returns data as before:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">wf</span> <span class="kw">&lt;-</span> <span class="st">"d4"</span>
<span class="no">M</span> <span class="kw">&lt;-</span> <span class="fl">30</span>
<span class="no">window</span> <span class="kw">&lt;-</span> <span class="st">"gauss"</span> <span class="co">#uniform"</span>

<span class="no">J</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">trunc</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">N</span>))-<span class="fl">3</span>

<span class="no">demusd.modwt</span> <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="no">returns</span>[,<span class="st">"DEM.USD"</span>], <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)
<span class="no">jpyusd.modwt</span> <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="no">returns</span>[,<span class="st">"JPY.USD"</span>], <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)
<span class="no">xrand.modwt</span> <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">returns</span>[,<span class="st">"DEM.USD"</span>])), <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)

<span class="no">xx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">demusd.modwt</span>, <span class="no">jpyusd.modwt</span>, <span class="no">xrand.modwt</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">xx</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"DEM.USD"</span>,<span class="st">"JPY.USD"</span>,<span class="st">"rand"</span>)

<span class="no">Lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/wave.local.multiple.regression.html">wave.local.multiple.regression</a></span>(<span class="no">xx</span>, <span class="no">M</span>, <span class="kw">window</span><span class="kw">=</span><span class="no">window</span>) <span class="co">#, ymaxr=1)</span></pre></body></html></div>
<p>The output from this function has the following main elements:<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<ul>
<li><p><em>cor</em>, similar as before but taking into the evolution over time. It contains <em>val</em>, <em>lo</em>, <em>up</em>, three matrices of wavelet correlation coefficients over time and corresponding lower and upper bounds confidence interval bounds.</p></li>
<li><p><em>reg</em>, with a list of matrices containing relevant regression statistics for all wavelet levels over time.</p></li>
<li><p><em>YmaxR</em>, with the same content as <em>wave.multiple.regression</em> before.</p></li>
</ul>
<p>The output can be fed into a <em>heatmap_</em> auxiliary routine to obtain a standard heat map, which is the recommended way to visualize the WLMC:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/heatmap_wave.local.multiple.correlation.html">heatmap_wave.local.multiple.correlation</a></span>(<span class="no">Lst</span>) <span class="co">#, xaxt="s", ci=NULL, pdf.write=NULL)</span></pre></body></html></div>
<p><img src="wavemulcor-vignette_files/figure-html/heat_wlmc-1.png" width="672"></p>
<p>The figure shows how the WLMC evolves both over time and across wavelet levels, the latter shown as time periods <span class="math inline">\((2^j,2^{j+1}]\)</span> after conversion into their corresponding time units intervals.</p>
<p>As nice as they are, heat maps cannot offer the information provided by the confidence intervals and, besides, cannot be sensibly used for visualizing WLMR output. For those we need to use the <em>plot_</em> auxiliary routines to obtain a standard WLMC plot:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_wave.local.multiple.correlation.html">plot_wave.local.multiple.correlation</a></span>(<span class="no">Lst</span>) <span class="co">#, xaxt="s")</span></pre></body></html></div>
<p><img src="wavemulcor-vignette_files/figure-html/plot_wlmc-1.png" width="672"></p>
<p>…and a standard WLMR plot:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_wave.local.multiple.regression.html">plot_wave.local.multiple.regression</a></span>(<span class="no">Lst</span>) <span class="co">#, xaxt="s")</span></pre></body></html></div>
<p><img src="wavemulcor-vignette_files/figure-html/plot_wlmr-1.png" width="672"></p>
<p>Both figures show, at one plot per wavelet level, the respective wavelet local multiple correlation and regression coefficients for the exchange rate returns with their corresponding 95% confidence interval upper and lower bounds.</p>
</div>
<div id="wlmcr-wavelet-local-multiple-cross-regression-and-cross-correlation" class="section level3">
<h3 class="hasAnchor">
<a href="#wlmcr-wavelet-local-multiple-cross-regression-and-cross-correlation" class="anchor"></a>WLMCR: wavelet local multiple cross-regression and cross-correlation</h3>
<p>Just as you were expecting by now, there are also routines that calculate local regressions at different lags and leads. The output structure should be obvious once we have learned to handle the previous <em>local</em> and <em>cross</em> functions, since WLMCR, and the simpler WLMCC, are but a combination of both features.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">wf</span> <span class="kw">&lt;-</span> <span class="st">"d4"</span>
<span class="no">M</span> <span class="kw">&lt;-</span> <span class="fl">30</span>
<span class="no">window</span> <span class="kw">&lt;-</span> <span class="st">"gauss"</span> <span class="co">#uniform"</span>
<span class="no">J</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">trunc</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">N</span>))-<span class="fl">3</span>
<span class="no">lmax</span> <span class="kw">&lt;-</span> <span class="fl">5</span>

<span class="no">demusd.modwt</span> <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="no">returns</span>[,<span class="st">"DEM.USD"</span>], <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)
<span class="no">jpyusd.modwt</span> <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="no">returns</span>[,<span class="st">"JPY.USD"</span>], <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)
<span class="no">rand.modwt</span>   <span class="kw">&lt;-</span> <span class="fu">brick.wall</span>(<span class="fu">modwt</span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">returns</span>[,<span class="st">"DEM.USD"</span>])), <span class="no">wf</span>, <span class="no">J</span>), <span class="no">wf</span>)

<span class="no">xx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">demusd.modwt</span>, <span class="no">jpyusd.modwt</span>, <span class="no">rand.modwt</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">xx</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"DEM.USD"</span>,<span class="st">"JPY.USD"</span>,<span class="st">"rand"</span>)

<span class="no">Lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/wave.local.multiple.cross.regression.html">wave.local.multiple.cross.regression</a></span>(<span class="no">xx</span>, <span class="no">M</span>, <span class="kw">window</span><span class="kw">=</span><span class="no">window</span>, <span class="kw">lag.max</span><span class="kw">=</span><span class="no">lmax</span>) <span class="co">#, ymaxr=1)</span></pre></body></html></div>
<p>As before, there are also auxiliary <em>heatmap_</em> and <em>plot_</em> routines to handle standard heat maps and plots similar to the ones presented above but extended over the requested lags and leads.</p>
<p>For example, <em>heatmap_wave.local.multiple.cross.correlation</em> produces a page of <span class="math inline">\(J+1\)</span> standard WLMC heat maps:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="../reference/heatmap_wave.local.multiple.cross.correlation.html">heatmap_wave.local.multiple.cross.correlation</a></span>(<span class="no">Lst</span>, <span class="kw">lmax</span><span class="kw">=</span><span class="no">lmax</span>, <span class="kw">lag.first</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="wavemulcor-vignette_files/figure-html/heat_wlmcc_lag-1.png" width="672"></p>
<div class="sourceCode" id="cb15"><html><body><pre class="r">             #, xaxt="s", ci=NULL, pdf.write=NULL)</pre></body></html></div>
<p>Note that we can use the option <em>lag.first=TRUE</em> to alter the role of lags and levels in the plots. That is, it will make one plot per lag, where the vertical axis are wavelet periods, same as with <em>heatmap_wave.local.multiple.correlation</em> before.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="../reference/heatmap_wave.local.multiple.cross.correlation.html">heatmap_wave.local.multiple.cross.correlation</a></span>(<span class="no">Lst</span>, <span class="kw">lmax</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">lag.first</span><span class="kw">=</span><span class="fl">TRUE</span>)
             <span class="co">#, xaxt="s", ci=NULL, pdf.write=NULL)</span></pre></body></html></div>
<p><img src="wavemulcor-vignette_files/figure-html/heat_wlmcc_lev-1.png" width="672"></p>
<p>Once again, if confidence intervals are required we need to use the <em>plot_</em> auxiliary routines to obtain a standard WLMCC plots:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_wave.local.multiple.cross.correlation.html">plot_wave.local.multiple.cross.correlation</a></span>(<span class="no">Lst</span>, <span class="no">lmax</span>, <span class="kw">lag.first</span><span class="kw">=</span><span class="fl">FALSE</span>) <span class="co">#, xaxt="s")</span></pre></body></html></div>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_wave.local.multiple.cross.regression.html">plot_wave.local.multiple.cross.regression</a></span>(<span class="no">Lst</span>, <span class="no">lmax</span>, <span class="kw">nsig</span><span class="kw">=</span><span class="fl">2</span>) <span class="co">#, xaxt="s")</span></pre></body></html></div>
<p>Their respective outputs are each made up of as many graphs as wavelet levels and typically can extend several pages, therefore they will not be presented in this vignette. However, it is sucintly described in the documentation of the package and you are kindly invited to try it.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-AguiaS14">
<p>Aguiar-Conraria, L., and M. J. Soares. 2014. “The Continuous Wavelet Transform: Moving Beyond Uni-and Bivariate Analysis.” <em>Journal of Economic Surveys</em> 28 (2): 344–75. <a href="https://doi.org/10.1111/joes.12012">https://doi.org/10.1111/joes.12012</a>.</p>
</div>
<div id="ref-Ferna12">
<p>Fernández-Macho, J. 2012. “Wavelet Multiple Correlation and Cross-Correlation: A Multiscale Analysis of Eurozone Stock Markets.” <em>Physica A: Statistical Mechanics</em> 391 (4): 1097–1104. <a href="https://doi.org/10.1016/j.physa.2011.11.002">https://doi.org/10.1016/j.physa.2011.11.002</a>.</p>
</div>
<div id="ref-Ferna18">
<p>———. 2018. “Time-Localized Wavelet Multiple Regression and Correlation.” <em>Physica A: Statistical Mechanics and Its Applications</em> 492 (February): 1226–38. <a href="https://doi.org/10.1016/j.physa.2017.11.050">https://doi.org/10.1016/j.physa.2017.11.050</a>.</p>
</div>
<div id="ref-Ferna19a">
<p>———. 2019. “Package Wavemulcor: Wavelet Multiple Regression and Correlation in R.” <em>Computing in Science &amp; Engineering</em> 21 (6): 63–73. <a href="https://doi.org/10.1109/mcse.2018.2875320">https://doi.org/10.1109/mcse.2018.2875320</a>.</p>
</div>
<div id="ref-GencaSW02">
<p>Gençay, R., F. Selçuk, and B. Whitcher. 2002. <em>An Introduction to Wavelets and Other Filtering Methods in Finance and Economics</em>. San Diego: Academic Press.</p>
</div>
<div id="ref-PerciW00">
<p>Percival, D. B., and A. T. Walden. 2000. <em>Wavelet Methods for Time Series Analysis</em>. Cambridge, UK: Cambridge University Press. <a href="https://doi.org/10.1017/cbo9780511841040">https://doi.org/10.1017/cbo9780511841040</a>.</p>
</div>
<div id="ref-Whitc15">
<p>Whitcher, B. 2015. “Waveslim: Basic Wavelet Routines for One-, Two- and Three-Dimensional Signal Processing.” <a href="https://CRAN.R-project.org/package=waveslim">https://CRAN.R-project.org/package=waveslim</a>.</p>
</div>
<div id="ref-WhitcGP00">
<p>Whitcher, B., P. Guttorp, and D. B. Percival. 2000. “Wavelet Analysis of Covariance with Application to Atmospheric Time Series.” <em>Journal of Geophysical Research: Atmospheres</em> 105 (D11): 14941–62. <a href="https://doi.org/10.1029/2000jd900110">https://doi.org/10.1029/2000jd900110</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>{ This feature needs <em>Lst</em> to be output from <em>wave.multiple.regression</em>.}<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>{ Alternatively, if only wavelet multiple cross-correlations are needed, we can use the legacy routine <em>wave.multiple.cross.correlation(xx, lmax)</em>.}<a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>{ Alternatively, if only wavelet local multiple correlations are needed, we can use the legacy <em>routine wave.local.multiple.correlation(xx, lmax)</em>.}<a href="#fnref3" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Javier Fernandez-Macho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
